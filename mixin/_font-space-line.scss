@use "sass:math";
@use "sass:meta";
@use "../functions" as fn;

@mixin m-font-space-line($space-size, $font-size: 1em){
	  // 判定用フラグ
  $is-font-static: fn.is-absolute-length($font-size);
  $is-space-static: fn.is-absolute-length($space-size);
  
	// フォントも余白も「静的（px/pt/単位なし）」なら、Sassで計算して数値を出す
  @if $is-font-static and $is-space-static {
	  letter-spacing: fn.font-space-line($space-size, $font-size);
  }
    // どちらかが動的（em/rem等）なら calc() を出力する
  @else {
    // letter-spacingは長さ単位が必要。calc(長さ/長さ)は不可。
    // $font-sizeが動的(clampなど)の場合、spaceをem変換するのはCSSでは不可能。
    // そのため、space自体をそのまま適用する形に倒すか、em前提ならそのまま出力します。
    
    @if $is-space-static {
      // ここに来るということは font-sizeは動的だが spaceは固定(px)。
      // clampされたフォントサイズに対して固定pxの字間を維持したいなら、px指定で良い。
      $space-size-px: fn.to-px-value($space-size);
      letter-spacing: #{$space-size-px}px;
    } 
    @else {
      // 両方動的、あるいはspaceがem指定ならそのまま出す
      letter-spacing: $space-size;
    }
  }
}